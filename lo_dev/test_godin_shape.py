"""
Test of godin_shape function.

RESULT 9/24/2015:    
Difference (std) from matlab version = 3.22184194463e-16
so the two are identical to machine precision
"""

# setup
import os; import sys
alp = os.path.abspath('../../LiveOcean/alpha')
if alp not in sys.path:
    sys.path.append(alp)
import zfun; reload(zfun)

f = zfun.godin_shape()

import numpy as np
# This has been copied in from the output of my matlab function
# /Users/PM5/Documents/tools/pandora/Z_functions/Z_godin_shape
ff = np.array([0.000069444444444,
0.000208333333333,
0.000416666666667,
0.000694444444444,
0.001041666666667,
0.001458333333333,
0.001944444444444,
0.002500000000000,
0.003125000000000,
0.003819444444444,
0.004583333333333,
0.005416666666667,
0.006319444444444,
0.007291666666667,
0.008333333333333,
0.009444444444444,
0.010625000000000,
0.011875000000000,
0.013194444444444,
0.014583333333333,
0.016041666666667,
0.017569444444444,
0.019166666666667,
0.020833333333333,
0.022430555555556,
0.023888888888889,
0.025208333333333,
0.026388888888889,
0.027430555555556,
0.028333333333333,
0.029097222222222,
0.029722222222222,
0.030208333333333,
0.030555555555556,
0.030763888888889,
0.030833333333333,
0.030763888888889,
0.030555555555556,
0.030208333333333,
0.029722222222222,
0.029097222222222,
0.028333333333333,
0.027430555555556,
0.026388888888889,
0.025208333333333,
0.023888888888889,
0.022430555555556,
0.020833333333333,
0.019166666666667,
0.017569444444444,
0.016041666666667,
0.014583333333333,
0.013194444444444,
0.011875000000000,
0.010625000000000,
0.009444444444444,
0.008333333333333,
0.007291666666667,
0.006319444444444,
0.005416666666667,
0.004583333333333,
0.003819444444444,
0.003125000000000,
0.002500000000000,
0.001944444444444,
0.001458333333333,
0.001041666666667,
0.000694444444444,
0.000416666666667,
0.000208333333333,
0.000069444444444])
   
print('Difference (std) from matlab version = ' + str(np.std(f - ff)))
